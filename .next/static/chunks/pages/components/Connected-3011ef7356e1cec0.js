(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[639],{7717:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/Connected",function(){return s(8001)}])},1283:function(e,t){"use strict";t.Z={src:"/_next/static/media/logo.1a4e4c4e.svg",height:36,width:153,blurWidth:0,blurHeight:0}},234:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var r=s(5893),a=s(7294),n=s(1283),l=s(3309),o=s.n(l);function i(e){let{siteUrl:t}=e,[s,l]=(0,a.useState)(n.Z),[i,c]=(0,a.useState)(""),[d,m]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[g,x]=(0,a.useState)(""),[f,p]=(0,a.useState)("");return(0,a.useEffect)(()=>{fetch("http://localhost:8000/scrape?url=".concat(t)).then(e=>e.json()).then(e=>{l(e.image),c(e.title),m(e.description),h(e.favicon),x(e.siteName),p(e.url)}).catch(e=>{console.error("An error occurred:",e)})},[]),(0,r.jsxs)("article",{className:"-mt-5 max-w-sm rounded overflow-hidden shadow-lg",children:[(0,r.jsx)("a",{href:f,target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)("img",{className:"w-full",src:s,alt:"image"})}),(0,r.jsxs)("div",{className:"px-6 py-4",children:[(0,r.jsx)("h2",{className:"font-bold text-xl mb-2 ".concat(o().poppinsMedium),children:i}),(0,r.jsx)("p",{className:"text-gray-700 text-base ".concat(o().poppinsRegular),children:d})]}),(0,r.jsxs)("div",{className:"flex gap-2 mx-5 my-2",children:[(0,r.jsx)("img",{src:u,alt:"Favicon",style:{objectFit:"cover"}}),(0,r.jsx)("a",{href:f,target:"_blank",rel:"noopener noreferrer",className:"".concat(o().poppinsRegular),children:g})]})]})}},8001:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var r=s(5893),a=s(7294),n=s(5675),l=s.n(n),o=s(1283),i=s(3309),c=s.n(i),d=s(3920),m={src:"/_next/static/media/emoji-icon.9c4802c2.svg",height:24,width:25,blurWidth:0,blurHeight:0},u={src:"/_next/static/media/send-message-icon.204b19ba.svg",height:24,width:25,blurWidth:0,blurHeight:0},h=s(1163),g=s(5915),x=s.n(g),f=s(8994),p=s(1425),b=s(9581),v=s(4393);function j(){let e=(0,h.useRouter)(),t=(0,a.useRef)(null),s=(0,a.useRef)(null),n=(0,a.useRef)(null),[i,g]=(0,a.useState)([]),[j,w]=(0,a.useState)([{name:"",message:"",time:""}]),[N,y]=(0,a.useState)([{name:"",message:"",time:""}]),[_,S]=(0,a.useState)(!1),[M,k]=(0,a.useState)(""),[C,E]=(0,a.useState)("allMessages"),[D,F]=(0,a.useState)([]),[O,A]=(0,a.useState)(e.asPath.split("=")[1]),[I,R]=(0,a.useState)(0),[Z,L]=(0,a.useState)(!1),[P,B]=(0,a.useState)([{name:"",message:"",time:""}]),[W,H]=(0,a.useState)(null);(0,a.useEffect)(()=>{A(e.asPath.split("=")[1])},[e.query.query]),(0,a.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("deletedMessages"));fetch("https://emoji-api.com/emojis?access_key=81b5e5f1c8f229449b4936039e5e60899f95f4c3").then(e=>e.json()).then(e=>g(e)),fetch("http://localhost:8000/users").then(e=>e.json()).then(e=>F(e)),fetch("http://localhost:8000/users/all").then(e=>e.json()).then(t=>{null!==e?B(t.filter(t=>!e.some(e=>Array.isArray(e)&&e.length>=2&&e[0]===t.message&&e[1]===t.time))):B(t)}),fetch("http://localhost:8000/users/".concat(O)).then(e=>e.json()).then(e=>w(e))},[]),(0,a.useEffect)(()=>{let t=(0,d.io)("http://localhost:3000");return H(t),t.on("onlineUsers",e=>{setOnlineUsers(e)}),t.on("user-disconnect",e=>{F(t=>t.filter(t=>t!==e))}),t.emit("user-connected",e.asPath.split("=")[1]),t.on("user-connected",e=>{F(e)}),()=>{t.disconnect()}},[]),(0,a.useEffect)(()=>{if(!W)return;let e=(e,t,s)=>{B([...N,{name:t,message:e,time:s}])};return W.on("receive-message",(e,t,s)=>{B([...P,{name:t,message:e,time:s}])}),()=>{W.off("receive-message",e)}},[W,P]),(0,a.useEffect)(()=>{if(!W)return;let e=(e,t,s)=>{w([...j,{name:t,message:e,time:s}])};return W.on("send-message-to-user",(e,t,s)=>{w([...j,{name:t,message:e,time:s}])}),()=>{W.off("send-message-to-user",e)}},[W,j]),(0,a.useEffect)(()=>{W&&W.on("delete-message",(e,t,s,r)=>{"allMessages"===t?(B(t=>t.filter((t,s)=>s!==e)),console.log("Index to be deleted is ",e)):(w(e=>e.filter((e,t)=>e.message!=s&&e.time!==r)),console.log("Only my messages will be deleted"))})},[W]);let V=e=>{k(e),S(!0)},X=e=>{if("allMessages"===C){W.emit("delete-message-for-me",P[e].message,P[e].time,"allMessages",O),B(t=>t.filter((t,s)=>t.message!==P[e].message&&t.time!==P[e].time));let t=JSON.parse(localStorage.getItem("deletedMessages"))||[];localStorage.setItem("deletedMessages",JSON.stringify([...t,[P[e].message,P[e].time]]))}else console.log("My messages to be deleted are ",j[e].message),W.emit("delete-message-for-me",j[e].message,j[e].time,"myMessages",O),w(t=>t.filter((t,s)=>t.message!==j[e].message&&t.time!==j[e].time))},J=e=>{if("allMessages"===C)P[e].name===O&&(W.emit("delete-message",e,P[e]._id,"allMessages",O,P[e].message,P[e].time),B(t=>t.filter((t,s)=>t.message!==P[e].message&&t.time!==P[e].time)));else{if(j[e].name!==O)return;W.emit("delete-message",e,j[e]._id,"myMessages",O,j[e].message,j[e].time),w(t=>t.filter((t,s)=>t.message!==j[e].message&&t.time!==j[e].time))}},T=()=>{""!==s.current.value&&(W.emit("send-message",s.current.value,O,"".concat(new Date().toLocaleString())),R(t.current.clientHeight+10),B([...P,{name:O,message:s.current.value,time:"".concat(new Date().toLocaleString())}]),s.current.value="")},U=e=>{s.current.value+=e};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("main",{className:"min-h-screen bg-[#edf0f8]",children:[(0,r.jsxs)("header",{className:"flex justify-between items-center pt-10 mx-10",children:[(0,r.jsx)(l(),{src:o.Z,alt:"Any chat application logo",className:"clear-right"}),(0,r.jsxs)("p",{className:"text-2xl",children:[" Online: ",D.length," "]})]}),(0,r.jsxs)("section",{className:"flex",children:[(0,r.jsxs)("div",{ref:t,className:"h-[${height}vh] w-[70%] bg-white m-auto rounded-xl",children:[(0,r.jsxs)(f.Z,{fullWidth:!0,open:_,onClose:()=>{S(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,r.jsx)(b.Z,{children:(0,r.jsx)("input",{ref:n,onChange:e=>e.target.value,type:"text",maxLength:1e3,className:"".concat(c().poppinsMedium," bg-[#f5f7fb] rounded-2xl shadow-lg mx-2 pl-4 w-[88%] h-12 border-2 border-solid border-[#d8dbe3] focus:outline-none focus:border-2 focus:border-solid focus:border-[#edf0f8] focus:transition-all focus:duration-500"),placeholder:"Send a message to ".concat(M)})}),(0,r.jsx)(p.Z,{children:(0,r.jsx)("button",{onClick:()=>{""!==n.current.value&&(W.emit("send-message-to-user",n.current.value,e.asPath.split("=")[1],"".concat(new Date().toLocaleString()),M),w(e=>[...e,{name:O,message:n.current.value,time:"".concat(new Date().toLocaleString())}]),S(!1))},className:"text-white hover:text-black font-semibold hover:border-2 hover:border-solid hover:border-[#434ce6] hover:bg-white hover:cursor-pointer hover:transition-all hover:duration-500 w-36 h-12 rounded-lg bg-[#434CE6]",children:" Send "})})]}),(0,r.jsxs)("nav",{className:"mb-10 flex flex-wrap justify-center text-md font-bold text-center text-white bg-[#343A40]",children:[(0,r.jsx)("button",{className:"px-4 py-3 ".concat("myMessages"===C?"bg-blue-600":""," hover:bg-gray-500 text-white rounded-lg  hover:cursor-pointer me-2"),onClick:()=>{E("myMessages")},children:" View my messages "}),(0,r.jsx)("button",{className:"px-4 py-3 ".concat("allMessages"===C?"bg-blue-600":""," hover:bg-gray-500 text-white rounded-lg  hover:cursor-pointer me-2"),onClick:()=>{E("allMessages")},children:" View all messages "})]}),(0,r.jsx)("div",{className:"flex flex-col mb-10 gap-10",children:"allMessages"===C?(0,r.jsx)(v.default,{messages:P,nickname:O,onDeleteMessage:J,onDeleteForMe:X}):(0,r.jsx)(v.default,{messages:j,nickname:O,onDeleteMessage:J,onDeleteForMe:X})}),(0,r.jsx)("div",{className:"".concat(Z?"".concat(x().fadeIn):"".concat(x().fadeOut)," mb-4 w-[20rem] h-[20rem] border-4 border-solid border-white flex flex-wrap mt-[4rem] overflow-y-auto bg-white rounded-xl"),children:i.map((e,t)=>(0,r.jsx)("div",{className:"flex gap-5",children:(0,r.jsxs)("p",{onClick:()=>U(e.character),className:"text-center text-2xl mt-5 hover:cursor-pointer",children:[" ",e.character," "]})},t))}),(0,r.jsxs)("footer",{className:"-mt-4 w-[100%] h-[10vh] bg-[#ced9de] rounded-b-lg flex justify-center gap-3",children:[(0,r.jsx)(l(),{onClick:()=>{L(e=>!e)},src:m,alt:"Smiling Emoji icon",className:"self-center hover:cursor-pointer"}),(0,r.jsx)("input",{onKeyDown:e=>{"Enter"===e.key&&T()},ref:s,onChange:e=>e.target.value,type:"text",maxLength:1e3,className:"self-center ".concat(c().poppinsMedium," bg-[#f5f7fb] rounded-2xl shadow-lg mx-2 pl-4 w-[88%] h-12 border-2 border-solid border-[#d8dbe3] focus:outline-none focus:border-2 focus:border-solid focus:border-[#edf0f8] focus:transition-all focus:duration-500"),placeholder:"Send a message"}),(0,r.jsxs)("button",{onClick:T,children:[" ",(0,r.jsx)(l(),{src:u,alt:"Send message icon",className:"self-center bg-[#9bb0bb] w-8 h-8 p-1 rounded-full hover:cursor-pointer hover:bg-[#5b6063] hover:transition-all hover:duration-500"})," "]})]})]}),(0,r.jsx)("aside",{className:"h-[100vh] w-96 bg-white mr-10 flex flex-col items-center mb-10",children:0!==D.length&&D.map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-2 mt-5 border-2 border-solid hover:bg-gray-200 border-[#d9d9d9] p-3 w-[90%] hover:cursor-pointer",onClick:()=>V(e),children:[(0,r.jsxs)("div",{className:"text-4xl size-12 bg-gray-500 hover:cursor-pointer hover:bg-green-300 hover:transition-all hover:duration-500 text-white text-center rounded-full mt-[2px]",children:[" ",e.charAt(0)," "]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("p",{className:"".concat(c().poppinsMedium),children:[" ",e," "]}),(0,r.jsx)("p",{className:"".concat(c().poppinsRegular),children:" Online "})]})]},t))})]})]})})}},1812:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=s(5893),a=s(7294),n=s(3309),l=s.n(n),o=s(8994),i=s(1425);function c(e){let{index:t,onDeleteClick:s,onDeleteForMe:n,name:c,nickname:d}=e,[m,u]=(0,a.useState)(!1),h=()=>{n(t)};return(0,r.jsxs)("div",{className:"relative inline-block text-left",children:[(0,r.jsx)(o.Z,{className:"flex justify-center",fullWidth:!0,open:m,onClose:()=>{u(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:(0,r.jsx)(i.Z,{className:"",children:c===d?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"w-[600px] bg-gray-100 flex flex-col items-center gap-1",children:[(0,r.jsx)("p",{className:"mb-5 ".concat(l().poppinsMedium),children:" Are you sure you want to delete? "}),(0,r.jsxs)("div",{className:"flex justify-start gap-3",children:[(0,r.jsx)("button",{className:"mb-5 text-white hover:text-black font-semibold hover:border-2 hover:border-solid hover:border-[#434ce6] hover:bg-white hover:cursor-pointer hover:transition-all hover:duration-500 w-48 h-12 rounded-lg bg-red-600",onClick:h,children:" Delete for me "}),(0,r.jsx)("button",{className:"text-white hover:text-black font-semibold hover:border-2 hover:border-solid hover:border-[#434ce6] hover:bg-white hover:cursor-pointer hover:transition-all hover:duration-500 w-48 h-12 rounded-lg bg-red-600",onClick:()=>{s(t)},children:" Delete for everyone "})]})]})}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"w-96 bg-gray-100 flex flex-col items-center gap-1",children:[(0,r.jsx)("p",{className:"mb-5 ".concat(l().poppinsMedium),children:" Are you sure you want to delete? "}),(0,r.jsx)("button",{className:"mb-5 text-white hover:text-black font-semibold hover:border-2 hover:border-solid hover:border-[#434ce6] hover:bg-white hover:cursor-pointer hover:transition-all hover:duration-500 w-48 h-12 rounded-lg bg-red-600",onClick:h,children:" Delete for me "})]})})})}),(0,r.jsx)("div",{className:"absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",tabIndex:"-1",children:(0,r.jsx)("ul",{className:"py-1",role:"none",children:(0,r.jsx)("li",{className:"text-gray-700 block px-4 py-2 text-sm ".concat(l().poppinsRegular," hover:bg-gray-300 hover:cursor-pointer"),role:"menuitem",tabIndex:"-1",id:"menu-item-0",onClick:()=>{u(!0)},children:"Delete"})})})]})}},4393:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=s(5893),a=s(7294),n=s(234),l=s(3309),o=s.n(l),i=s(1812);function c(e){let{messages:t,nickname:s,onDeleteMessage:l,onDeleteForMe:c}=e,[d,m]=(0,a.useState)(Array.isArray(t)?Array(t.length).fill(!1):[]),[u,h]=(0,a.useState)(0),g=e=>{m(t=>{let s=[...t];return s[e]=!s[e],s}),h(e)},x=e=>/(https?:\/\/[^\s]+)/g.test(e),f=e=>{m(t=>{let s=[...t];return s[e]=!1,s})},p=e=>{l(e),f(e)},b=e=>{c(e),f(e)};return Array.isArray(t)&&0!==t.length?(0,r.jsx)(r.Fragment,{children:t.map((e,t)=>(0,r.jsx)(a.Fragment,{children:e&&(0,r.jsx)(r.Fragment,{children:x(e.message)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"break-words px-4 w-[30%] text-center ".concat(o().poppinsMedium," ").concat(e.name===s?"text-white bg-blue-500 self-end mr-10":"text-[#737070] bg-[#D6DCE3] mx-10"," mt-5 rounded-tr-3xl rounded-tl-3xl rounded-br-3xl"),children:e.message.substring(0,e.message.indexOf("http"))}),(0,r.jsx)("div",{className:"".concat(e.name===s?"flex justify-end mr-10":"ml-10"),children:(0,r.jsx)(n.default,{siteUrl:e.message.substring(e.message.indexOf("http"))})}),(0,r.jsxs)("p",{className:"".concat(o().poppinsMedium," text-[#737070] -mt-12 ").concat(e.name===s?"self-end mr-10":"mx-10"," py-2"),children:[e.name===s?"You":e.name,", ",(0,r.jsx)("span",{className:"text-[#a2a2a2]",children:e.time})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:" w-[30%] ".concat(e.name===s?"text-white bg-blue-500 self-end mr-10":"text-[#737070] bg-[#D6DCE3] mx-10"," mt-5 rounded-tr-3xl rounded-tl-3xl rounded-br-3xl"),children:[(0,r.jsx)("span",{className:"hover:cursor-pointer mr-5 self-center float-right relative top-0",onClick:()=>g(t),children:"▾"}),(0,r.jsx)("p",{className:"break-words px-4 text-center ".concat(o().poppinsMedium),children:e.message})]}),d[t]&&(0,r.jsx)("div",{className:"".concat(e.name===s?"self-end mr-10 -mt-16":"ml-96 -mt-16"),children:(0,r.jsx)(i.default,{name:e.name,nickname:s,index:t,onDeleteClick:p,onDeleteForMe:b})}),(0,r.jsxs)("p",{className:"".concat(o().poppinsMedium," text-[#737070] -mt-12 ").concat(e.name===s?"self-end mr-10":"mx-10"," py-2"),children:[e.name===s?"You":e.name,", ",(0,r.jsx)("span",{className:"text-[#a2a2a2]",children:e.time})]})]})})},t))}):null}},5915:function(e){e.exports={fadeIn:"Connected_fadeIn__XBpKl",fadeOut:"Connected_fadeOut__MedXx",active:"Connected_active__FL_oS"}},3309:function(e){e.exports={poppinsExtraBold:"Fonts_poppinsExtraBold__a95Vf",poppinsMedium:"Fonts_poppinsMedium__4nx49",poppinsRegular:"Fonts_poppinsRegular__YuFNr",poppinsSemiBold:"Fonts_poppinsSemiBold__TIEwV"}}},function(e){e.O(0,[675,978,463,888,774,179],function(){return e(e.s=7717)}),_N_E=e.O()}]);